// RPC defines RPC messages that can be received by the Fluid instance.
// These are not actually RPC endpoints since we send them over NATS, we
// just define the messages here for versioning purposes.
syntax = "proto3";

package fluid.rpc.v1;

option go_package = "github.com/liquidspill/proto/go/fluid/rpc/v1;rpcv1";

import "nexus/controlplane/v1/control_plane.proto";

message GetQueryResultRequest {
  string query_result_pid = 1;
  // The path on object storage where the query result is stored.
  // This is expected to be a bucket that the Fluid instance has
  // access to.
  string data_path = 2;
}

message GetQueryResultResponse {
  nexus.controlplane.v1.QueryExecutionResult results = 1;
}

message Error {
  ErrorKind kind = 1;
  string message = 2;
}

enum ErrorKind {
  UNKNOWN = 0;
  // The request is malformed and was unable to be decoded by the server
  BAD_REQUEST = 1;
  // An error encountered while responding to the client
  RPC_ERROR = 2;
  // An error while interacting with object storage
  OBJECT_STORAGE_ERROR = 3;

  // NOT_FOUND = 2;
  // ALREADY_EXISTS = 3;
  // PERMISSION_DENIED = 4;
  // RESOURCE_EXHAUSTED = 5;
  // FAILED_PRECONDITION = 6;
  // ABORTED = 7;
  // OUT_OF_RANGE = 8;
  // UNIMPLEMENTED = 9;
  // INTERNAL = 10;
  // UNAVAILABLE = 11;
  // DATA_LOSS = 12;
}
